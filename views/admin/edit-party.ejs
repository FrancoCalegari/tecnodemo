<%- include('../partials/header', {admin: true}) %>

<div class="admin-container">
	<div class="admin-header">
		<h2>Editar Fiesta</h2>
		<a href="/admin/dashboard" class="btn btn-secondary">Volver al Dashboard</a>
	</div>

	<div
		style="
			background: #111;
			padding: 2rem;
			border-radius: 8px;
			border: 1px solid #333;
		"
	>
		<form
			action="/admin/update/<%= party.id %>"
			method="POST"
			enctype="multipart/form-data"
		>
			<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem">
				<div class="form-group">
					<label>Titulo del Evento</label>
					<input
						type="text"
						name="title"
						class="form-control"
						value="<%= party.title %>"
						required
					/>
				</div>
				<div class="form-group">
					<label>Texto de Fecha (Para Mostrar)</label>
					<input
						type="text"
						name="dateDisplay"
						class="form-control"
						value="<%= party.date %>"
						required
					/>
				</div>
			</div>

			<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem">
				<div class="form-group">
					<label>Fecha y Hora de Inicio</label>
					<input
						type="datetime-local"
						name="startDateTime"
						class="form-control"
						value="<%= party.startDateTime || '' %>"
					/>
				</div>
				<div class="form-group">
					<label>Fecha y Hora de Fin</label>
					<input
						type="datetime-local"
						name="endDateTime"
						class="form-control"
						value="<%= party.endDateTime || '' %>"
					/>
				</div>
			</div>

			<div class="form-group">
				<label>Ubicaci√≥n del Evento</label>
				<input
					type="text"
					name="location"
					class="form-control"
					value="<%= party.location || '' %>"
				/>
			</div>

			<div class="form-group">
				<label>Flyer / Imagen</label>
				<% if (party.image) { %>
				<div style="margin-bottom: 1rem">
					<img
						src="<%= party.image %>"
						alt="Current flyer"
						style="max-width: 200px; border-radius: 4px; border: 1px solid #333"
					/>
					<p style="color: #888; font-size: 0.9rem; margin-top: 0.5rem">
						Imagen actual - Deja los campos vacios para mantenerla
					</p>
				</div>
				<% } %>
				<div
					style="
						display: flex;
						gap: 1rem;
						align-items: center;
						margin-bottom: 0.5rem;
					"
				>
					<label style="margin: 0">
						<input
							type="radio"
							name="imageType"
							value="file"
							checked
							onchange="toggleImageInput()"
						/>
						Subir archivo
					</label>
					<label style="margin: 0">
						<input
							type="radio"
							name="imageType"
							value="url"
							onchange="toggleImageInput()"
						/>
						URL de imagen
					</label>
				</div>
				<input
					type="file"
					name="image"
					id="imageFile"
					class="form-control"
					accept="image/*"
				/>
				<input
					type="text"
					name="imageUrl"
					id="imageUrl"
					class="form-control"
					placeholder="https://ejemplo.com/imagen.jpg"
					style="display: none"
				/>
			</div>

			<div class="form-group">
				<label>Descripcion</label>
				<textarea name="description" class="form-control" rows="4" required>
<%= party.description %></textarea
				>
			</div>

			<div class="form-group">
				<label>Line Up (Participantes)</label>
				<textarea name="lineup" class="form-control" rows="3">
<%= party.lineup || '' %></textarea
				>
			</div>

			<div class="form-group">
				<label>Sponsors</label>
				<input
					type="text"
					name="sponsors"
					class="form-control"
					value="<%= party.sponsors || '' %>"
				/>
			</div>

			<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem">
				<div class="form-group">
					<label>Link de Entradas (URL)</label>
					<input
						type="text"
						name="ticketLink"
						class="form-control"
						value="<%= party.ticketLink || '' %>"
					/>
				</div>
				<div class="form-group">
					<label>Video Embed (Iframe Code)</label>
					<input
						type="text"
						name="video"
						class="form-control"
						value="<%= party.video || '' %>"
					/>
				</div>
			</div>

			<div style="display: flex; gap: 1rem; margin-top: 2rem">
				<button type="submit" class="btn">Actualizar Fiesta</button>
				<a href="/admin/dashboard" class="btn btn-secondary">Cancelar</a>
			</div>
		</form>
	</div>
</div>

<script>
	function toggleImageInput() {
		const imageType = document.querySelector(
			'input[name="imageType"]:checked'
		).value;
		const fileInput = document.getElementById("imageFile");
		const urlInput = document.getElementById("imageUrl");

		if (imageType === "file") {
			fileInput.style.display = "block";
			urlInput.style.display = "none";
			urlInput.value = "";
		} else {
			fileInput.style.display = "none";
			urlInput.style.display = "block";
		}
	}
</script>

<%- include('../partials/footer') %>
